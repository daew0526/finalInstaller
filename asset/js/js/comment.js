(()=>{const e=document.querySelector(".comment__container ul"),t=document.querySelector(".comment"),n=document.querySelector(".comment__text"),c=document.querySelectorAll(".comment__list__delBtn"),a=document.querySelectorAll(".comment__list__editBtn"),m=async e=>{e.preventDefault();const t=document.querySelector(".comment__edit__text").value,n=e.target.parentNode,c=n.dataset.commentId,a=await fetch(`/api/installer/${c}/comment`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t})});if(201===a.status){const e=await a.json();((e,t,n)=>{n.dataset.commentId=e,n.children[1].innerText=` ${t}`,(e=>{e.children[4].classList.add("remove")})(n)})(e.editCommentId,e.text,n)}},o=e=>{(e=>{const t=document.createDocumentFragment(),n=document.createElement("form");n.className="comment",n.addEventListener("submit",m);const c=document.createElement("textarea");c.className="comment__text comment__edit__text",c.placeholder="Write your edit comment...",c.cols="20",c.rows="10";const a=document.createElement("button");a.innerText="Edit Submit",n.appendChild(c),n.appendChild(a),t.appendChild(n),e.after(t)})(e.target)},d=async t=>{const n=t.target.parentNode,c=n.dataset.commentId;201===(await fetch(`/api/installer/${c}/comment`,{method:"DELETE"})).status&&e.removeChild(n)};t&&(t.addEventListener("submit",(async t=>{t.preventDefault();const c=n.value,a=document.querySelector(".installer").dataset.installerId;if(""===c||" "===c)return;const m=await fetch(`/api/installer/${a}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:c})});if(201===m.status){const t=await m.json();((t,n)=>{const c=document.createDocumentFragment(),a=document.createElement("li");a.className="comment__list",a.dataset.commentId=t;const m=document.createElement("i");m.className="fas fa-comment";const s=document.createElement("span");s.innerText=` ${n}`,s.className="comment__list__txt";const l=document.createElement("button");l.innerHTML="❌",l.className="comment__list__delBtn",l.addEventListener("click",d);const i=document.createElement("button");i.innerHTML="✅",i.className="comment__list__editBtn",i.addEventListener("click",o),a.appendChild(m),a.appendChild(s),a.appendChild(l),a.appendChild(i),c.appendChild(a),e.prepend(c)})(t.newCommentId,t.text)}m.status,n.value=""})),c&&c.forEach((e=>e.addEventListener("click",d))),a&&a.forEach((e=>e.addEventListener("click",o))))})();